{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Yock\\\\Desktop\\\\react-test\\\\coffee\\\\component\\\\DonutChart.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useRef } from \"react\";\nimport * as d3 from \"d3\";\n\nvar Pie = function Pie(props) {\n  _s();\n\n  var ref = useRef(null);\n  var cache = useRef(props.data);\n  var createPie = d3.pie().value(function (d) {\n    return d.value;\n  }).sort(null);\n  var createArc = d3.arc().innerRadius(props.innerRadius).outerRadius(props.outerRadius);\n  var colors = d3.scaleOrdinal(d3.schemeCategory10);\n  var format = d3.format(\".2f\");\n  useEffect(function () {\n    var data = createPie(props.data);\n    var prevData = createPie(cache.current);\n    var group = d3.select(ref.current);\n    var groupWithData = group.selectAll(\"g.arc\").data(data);\n    groupWithData.exit().remove();\n    var groupWithUpdate = groupWithData.enter().append(\"g\").attr(\"class\", \"arc\");\n    var path = groupWithUpdate.append(\"path\").merge(groupWithData.select(\"path.arc\"));\n\n    var arcTween = function arcTween(d, i) {\n      var interpolator = d3.interpolate(prevData[i], d);\n      return function (t) {\n        return createArc(interpolator(t));\n      };\n    };\n\n    path.attr(\"class\", \"arc\").attr(\"fill\", function (d, i) {\n      return colors(i);\n    }).transition().attrTween(\"d\", arcTween);\n    var text = groupWithUpdate.append(\"text\").merge(groupWithData.select(\"text\"));\n    text.attr(\"text-anchor\", \"middle\").attr(\"alignment-baseline\", \"middle\").style(\"fill\", \"white\").style(\"font-size\", 10).transition().attr(\"transform\", function (d) {\n      return \"translate(\".concat(createArc.centroid(d), \")\");\n    }).tween(\"text\", function (d, i, nodes) {\n      var interpolator = d3.interpolate(prevData[i], d);\n      return function (t) {\n        return d3.select(nodes[i]).text(format(interpolator(t).value));\n      };\n    });\n    cache.current = props.data;\n  }, [props.data]);\n  return __jsx(\"svg\", {\n    width: props.width,\n    height: props.height,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    href: \"#\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }, __jsx(\"g\", {\n    ref: ref,\n    transform: \"translate(\".concat(props.outerRadius, \" \").concat(props.outerRadius, \")\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 19\n    }\n  })));\n};\n\n_s(Pie, \"MmPCtGo/I6HdvmXfA/do21yyKOc=\");\n\n_c = Pie;\nexport default Pie;\n\nvar _c;\n\n$RefreshReg$(_c, \"Pie\");","map":{"version":3,"sources":["C:/Users/Yock/Desktop/react-test/coffee/component/DonutChart.js"],"names":["React","useEffect","useRef","d3","Pie","props","ref","cache","data","createPie","pie","value","d","sort","createArc","arc","innerRadius","outerRadius","colors","scaleOrdinal","schemeCategory10","format","prevData","current","group","select","groupWithData","selectAll","exit","remove","groupWithUpdate","enter","append","attr","path","merge","arcTween","i","interpolator","interpolate","t","transition","attrTween","text","style","centroid","tween","nodes","width","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport * as d3 from \"d3\";\r\n\r\nconst Pie = props => {\r\n  const ref = useRef(null);\r\n  const cache = useRef(props.data);\r\n  const createPie = d3\r\n    .pie()\r\n    .value(d => d.value)\r\n    .sort(null);\r\n  const createArc = d3\r\n    .arc()\r\n    .innerRadius(props.innerRadius)\r\n    .outerRadius(props.outerRadius);\r\n  const colors = d3.scaleOrdinal(d3.schemeCategory10);\r\n  const format = d3.format(\".2f\");\r\n\r\n  useEffect(\r\n    () => {\r\n      const data = createPie(props.data);\r\n      const prevData = createPie(cache.current);\r\n      const group = d3.select(ref.current);\r\n      const groupWithData = group.selectAll(\"g.arc\").data(data);\r\n\r\n      groupWithData.exit().remove();\r\n\r\n      const groupWithUpdate = groupWithData\r\n        .enter()\r\n        .append(\"g\")\r\n        .attr(\"class\", \"arc\");\r\n\r\n      const path = groupWithUpdate\r\n        .append(\"path\")\r\n        .merge(groupWithData.select(\"path.arc\"));\r\n\r\n      const arcTween = (d, i) => {\r\n        const interpolator = d3.interpolate(prevData[i], d);\r\n\r\n        return t => createArc(interpolator(t));\r\n      };\r\n\r\n      path\r\n        .attr(\"class\", \"arc\")\r\n        .attr(\"fill\", (d, i) => colors(i))\r\n        .transition()\r\n        .attrTween(\"d\", arcTween);\r\n\r\n      const text = groupWithUpdate\r\n        .append(\"text\")\r\n        .merge(groupWithData.select(\"text\"));\r\n\r\n      text\r\n        .attr(\"text-anchor\", \"middle\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"fill\", \"white\")\r\n        .style(\"font-size\", 10)\r\n        .transition()\r\n        .attr(\"transform\", d => `translate(${createArc.centroid(d)})`)\r\n        .tween(\"text\", (d, i, nodes) => {\r\n          const interpolator = d3.interpolate(prevData[i], d);\r\n\r\n          return t => d3.select(nodes[i]).text(format(interpolator(t).value));\r\n        });\r\n\r\n      cache.current = props.data;\r\n    },\r\n    [props.data]\r\n  );\r\n\r\n  return (\r\n    <svg width={props.width} height={props.height}>\r\n      <a href=\"#\"><g\r\n        ref={ref}\r\n        transform={`translate(${props.outerRadius} ${props.outerRadius})`}\r\n      /></a>\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default Pie;\r\n"]},"metadata":{},"sourceType":"module"}